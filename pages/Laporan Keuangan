<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Input Jurnal</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f4f4f4;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 20px;
    }
    .container {
      width: 90%;
      max-width: 900px;
      background: white;
      border-radius: 8px;
      box-shadow: 0px 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
    }
    .judul-utama {
      text-align: center;
      font-size: 24px;
      font-weight: bold;
    }
    .judul-bawah {
      text-align: center;
      margin: 10px 0;
    }
    .judul-bawah input {
      border: none;
      border-bottom: 1px solid #000;
      text-align: center;
      width: 70%;
      display: block;
      margin: 8px auto;
    }
    .baris-kedua { font-size: 18px; }
    .baris-ketiga { font-size: 12px; }

    .input-group {
      margin: 10px 0;
    }
    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
    }
    input, select {
      padding: 8px;
      font-size: 14px;
      width: 100%;
      box-sizing: border-box;
      border-radius: 5px;
      border: 1px solid #ccc;
    }

    .button-group {
      margin: 15px 0;
      display: flex;
      justify-content: center;
      gap: 10px;
    }

    button {
      padding: 10px 15px;
      border: none;
      color: #fff;
      border-radius: 5px;
      cursor: pointer;
    }
    #addRow { background-color: #28a745; }
    #deleteRow { background-color: #dc3545; }
    #savePdf { background-color: #007bff; }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th, td {
      border: 1px solid #000;
      padding: 8px;
      text-align: center;
      font-size: 14px;
    }

    th {
      background-color: #007bff;
      color: white;
    }

    .total-row td {
      font-weight: bold;
      background-color: #f0f0f0;
    }

    @media (max-width: 768px) {
      .judul-bawah input {
        width: 90%;
      }
      th, td {
        font-size: 12px;
        padding: 6px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="judul-utama">Jurnal Umum</div>

    <div class="judul-bawah">
      <input type="text" id="judulManual" placeholder="Judul tambahan (manual)" class="baris-kedua">
      <input type="text" id="barisKetiga" placeholder="Baris tambahan lainnya" class="baris-ketiga">
    </div>

    <div class="input-group">
      <label for="tanggal">Tanggal:</label>
      <input type="date" id="tanggal">
    </div>
    <div class="input-group">
      <label for="keterangan">Keterangan:</label>
      <input type="text" id="keterangan">
    </div>
    <div class="input-group">
      <label for="ref">Ref:</label>
      <input type="text" id="ref">
    </div>
    <div class="input-group">
      <label for="tipe">Tipe:</label>
      <select id="tipe">
        <option value="debit">Debit</option>
        <option value="kredit">Kredit</option>
      </select>
    </div>
    <div class="input-group">
      <label for="jumlah">Jumlah:</label>
      <input type="number" id="jumlah">
    </div>

    <div class="button-group">
      <button id="addRow">Tambah Baris</button>
      <button id="deleteRow">Hapus Baris Terakhir</button>
      <button id="savePdf">Simpan PDF</button>
    </div>

    <table>
      <thead>
        <tr>
          <th>Tanggal</th>
          <th>Keterangan</th>
          <th>Ref</th>
          <th>Debit (Rp)</th>
          <th>Kredit (Rp)</th>
        </tr>
      </thead>
      <tbody id="tabelJurnal"></tbody>
      <tfoot>
        <tr class="total-row">
          <td colspan="3">Total</td>
          <td id="totalDebit">0</td>
          <td id="totalKredit">0</td>
        </tr>
      </tfoot>
    </table>
  </div>

  <script>
    const tabel = document.getElementById("tabelJurnal");
    const totalDebitEl = document.getElementById("totalDebit");
    const totalKreditEl = document.getElementById("totalKredit");
    let data = [];

    function formatTanggal(input) {
      const tgl = new Date(input);
      const options = { day: '2-digit', month: 'long', year: 'numeric' };
      return tgl.toLocaleDateString('id-ID', options);
    }

    function updateTable() {
      tabel.innerHTML = '';
      let totalDebit = 0;
      let totalKredit = 0;

      data.forEach(d => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${formatTanggal(d.tanggal)}</td>
          <td>${d.keterangan}</td>
          <td>${d.ref}</td>
          <td>${d.tipe === "debit" ? d.jumlah.toLocaleString() : "-"}</td>
          <td>${d.tipe === "kredit" ? d.jumlah.toLocaleString() : "-"}</td>
        `;
        tabel.appendChild(row);
        if (d.tipe === "debit") totalDebit += d.jumlah;
        else totalKredit += d.jumlah;
      });

      totalDebitEl.textContent = totalDebit.toLocaleString();
      totalKreditEl.textContent = totalKredit.toLocaleString();
    }

    document.getElementById("addRow").addEventListener("click", () => {
      const tanggal = document.getElementById("tanggal").value;
      const keterangan = document.getElementById("keterangan").value;
      const ref = document.getElementById("ref").value;
      const tipe = document.getElementById("tipe").value;
      const jumlah = parseFloat(document.getElementById("jumlah").value);

      if (!tanggal || !keterangan || isNaN(jumlah)) {
        alert("Mohon lengkapi semua data.");
        return;
      }

      data.push({ tanggal, keterangan, ref, tipe, jumlah });
      updateTable();
    });

    document.getElementById("deleteRow").addEventListener("click", () => {
      data.pop();
      updateTable();
    });

    document.getElementById("savePdf").addEventListener("click", () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(16);
      doc.text("Jurnal Umum", 105, 10, { align: 'center' });

      const baris2 = document.getElementById("judulManual").value || "";
      const baris3 = document.getElementById("barisKetiga").value || "";

      doc.setFontSize(12);
      doc.text(baris2, 105, 20, { align: 'center' });
      doc.setFontSize(10);
      doc.text(baris3, 105, 28, { align: 'center' });

      const rows = data.map(d => [
        formatTanggal(d.tanggal),
        d.keterangan,
        d.ref,
        d.tipe === "debit" ? d.jumlah.toLocaleString() : "-",
        d.tipe === "kredit" ? d.jumlah.toLocaleString() : "-"
      ]);

      rows.push(["", "Total", "", totalDebitEl.textContent, totalKreditEl.textContent]);

      doc.autoTable({
        head: [["Tanggal", "Keterangan", "Ref", "Debit (Rp)", "Kredit (Rp)"]],
        body: rows,
        startY: 35,
        styles: {
          halign: 'center',
          valign: 'middle',
          lineWidth: 0.1,
          lineColor: 0,
          fontSize: 10,
        },
        theme: 'grid'
      });

      doc.save("Jurnal_Umum.pdf");
    });
  </script>
</body>
</html>
